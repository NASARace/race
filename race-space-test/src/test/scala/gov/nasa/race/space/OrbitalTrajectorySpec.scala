/*
 * Copyright (c) 2022, United States Government, as represented by the
 * Administrator of the National Aeronautics and Space Administration.
 * All rights reserved.
 *
 * The RACE - Runtime for Airspace Concept Evaluation platform is licensed
 * under the Apache License, Version 2.0 (the "License"); you may not use
 * this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0.
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package gov.nasa.race.space

import gov.nasa.race.common.Xyz
import gov.nasa.race.geo.{Datum, GeoPosition}
import gov.nasa.race.test.RaceSpec
import gov.nasa.race.uom.DateTime
import gov.nasa.race.uom.Time.Seconds
import org.scalatest.flatspec.AnyFlatSpec

/**
 * unit tests for OrbitalTrajectorySpec
 */
class OrbitalTrajectorySpec extends AnyFlatSpec with RaceSpec {

  val data30 = Array[Xyz](  // 30 sec timestep - too large
    Xyz( -254449.10104765836, -2110217.5468676058, 6875969.797531685 ),
    Xyz( -395241.6006715917, -2276136.813105533, 6816268.880951873 ),
    Xyz( -536377.2308944219, -2439269.799874288, 6750021.67962635 ),
    Xyz( -677708.9057847983, -2599459.7114684815, 6677291.471698869 ),
    Xyz( -819088.6565758868, -2756553.1752673737, 6598147.740332178 ),
    Xyz( -960367.7864405946, -2910400.390787938, 6512666.11111705 ),
    Xyz( -1101397.026844414, -3060855.27503677, 6420928.283776455 ),
    Xyz( -1242026.6953311013, -3207775.60402386, 6323021.958184356 ),
    Xyz( -1382106.854593696, -3351023.150300923, 6219040.754722477 ),
    Xyz( -1521487.4726755605, -3490463.816387996, 6109084.129002338 ),
    Xyz( -1660018.5841454417, -3625967.763951614, 5993257.280984711 ),
    Xyz( -1797550.4520818419, -3757409.53859949, 5871671.058533401 ),
    Xyz( -1933933.730701718, -3884668.190156211, 5744441.855445823 ),
    Xyz( -2069019.6284599053, -4007627.3882866413, 5611691.504008971 ),
    Xyz( -2202660.071444846, -4126175.533334489, 5473547.162135268 ),
    Xyz( -2334707.866888154, -4240205.862246447, 5330141.195139851 ),
    Xyz( -2465016.86660575, -4349616.5494512785, 5181611.052228695 ),
    Xyz( -2593442.1301807193, -4454310.802570951, 5028099.13777233 ),
    Xyz( -2719840.0876962706, -4554196.952838382, 4869752.677450765 ),
    Xyz( -2844068.701823615, -4649188.540103241, 4706723.579361066 ),
    Xyz( -2965987.6290653697, -4739204.392310337, 4539168.290189018 ),
    Xyz( -3085458.3799558575, -4824168.699338229, 4367247.6465533655 ),
    Xyz( -3202344.4780117115, -4904011.081092819, 4191126.7216420663 ),
    Xyz( -3316511.617230272, -4978666.649752823, 4010974.667268055 ),
    Xyz( -3427827.817927375, -5048076.0660743, 3826964.551479699 ),
    Xyz( -3536163.5807086183, -5112185.589662435, 3639273.1918736254 ),
    Xyz( -3641392.038365792, -5170947.123129769, 3448080.984763475 ),
    Xyz( -3743389.1054900773, -5224318.250065767, 3253571.730369655 ),
    Xyz( -3842033.6255953177, -5272262.266751615, 3055932.45420137 ),
    Xyz( -3937207.515548003, -5314748.207557411, 2855353.2248159987 ),
    Xyz( -4028795.9070961187, -5351750.863977021, 2652026.9681428527 ),
    Xyz( -4116687.28529879, -5383250.797255264, 2446149.278572011 ),
    Xyz( -4200773.623657173, -5409234.3445774885, 2237918.22701441 ),
    Xyz( -4280950.515751731, -5429693.618798989, 2027534.1661481415 ),
    Xyz( -4357117.303196193, -5444626.5017029485, 1815199.5330706213 ),
    Xyz( -4429177.199721722, -5454036.630784707, 1601118.6495873346 ),
    Xyz( -4497037.411210703, -5457933.379572852, 1385497.5203687549 ),
  )

   val data5 = Array[Xyz]( // 5 sec timestep
     Xyz( -254449.10104765836, -2110217.5468676058, 6875969.797531685 ),
     Xyz( -277884.4771390634, -2138057.496000557, 6866476.745428851 ),
     Xyz( -301332.77021687455, -2165823.74052206, 6856800.505929869 ),
     Xyz( -324793.3053472864, -2193515.535623717, 6846941.335741227 ),
     Xyz( -348265.40671920404, -2221132.1389410864, 6836899.4964287095 ),
     Xyz( -371748.397663177, -2248672.8105737446, 6826675.25441077 ),
     Xyz( -395241.6006715917, -2276136.813105533, 6816268.880951873 ),
     Xyz( -418744.33741735667, -2303523.411624115, 6805680.652155864 ),
     Xyz( -442255.9287739587, -2330831.8737412393, 6794910.848958975 ),
     Xyz( -465775.69483502023, -2358061.4696123116, 6783959.7571228715 ),
     Xyz( -489302.95493387594, -2385211.471956268, 6772827.667227488 ),
     Xyz( -512837.0276630784, -2412281.1560753253, 6761514.874663768 ),
     Xyz( -536377.2308944219, -2439269.799874288, 6750021.67962635 ),
     Xyz( -559922.8817983582, -2466176.683880347, 6738348.387106 ),
     Xyz( -583473.2968637657, -2493001.091262225, 6726495.306882101 ),
     Xyz( -607027.791918451, -2519742.3078500545, 6714462.753514696 ),
     Xyz( -630585.682147817, -2546399.6221539513, 6702251.046336917 ),
     Xyz( -654146.2821159409, -2572972.3253839253, 6689860.509446698 ),
     Xyz( -677708.9057847983, -2599459.7114684815, 6677291.471698869 ),
     Xyz( -701272.8665343872, -2625861.077074111, 6664544.266696822 ),
     Xyz( -724837.4771824973, -2652175.7216237513, 6651619.232784292 ),
     Xyz( -748402.050005445, -2678402.9473162116, 6638516.713036644 ),
     Xyz( -771965.896757331, -2704542.0591448066, 6625237.0552524375 ),
     Xyz( -795528.328690507, -2730592.364915751, 6611780.611944748 ),
     Xyz( -819088.6565758868, -2756553.1752673737, 6598147.740332178 ),
     Xyz( -842646.1907226052, -2782423.803688308, 6584338.80232997 ),
     Xyz( -866200.24099845, -2808203.5665360726, 6570354.164540945 ),
     Xyz( -889750.1168504804, -2833891.783055585, 6556194.1982462155 ),
     Xyz( -913295.1273245327, -2859487.77539744, 6541859.279395887 ),
     Xyz( -936834.5810862374, -2884990.868636051, 6527349.788599611 ),
     Xyz( -960367.7864405946, -2910400.390787938, 6512666.11111705 ),
     Xyz( -983894.0513530122, -2935715.6728296243, 6497808.636848125 ),
     Xyz( -1007412.6834691444, -2960936.0487158885, 6482777.760323197 ),
     Xyz( -1030922.9901354888, -2986060.8553975374, 6467573.880693153 ),
     Xyz( -1054424.2784201037, -3011089.4328393056, 6452197.40171924 ),
     Xyz( -1077915.8551324685, -3036021.12403717, 6436648.731763189 ),
     Xyz( -1101397.026844414, -3060855.27503677, 6420928.283776455 ),
     Xyz( -1124867.0999102104, -3085591.2349502626, 6405036.475290209 ),
     Xyz( -1148325.3804876744, -3110228.355974066, 6388973.728404601 ),
     Xyz( -1171771.1745581557, -3134765.9934064853, 6372740.469777998 ),
     Xyz( -1195203.7879474983, -3159203.5056645907, 6356337.130616377 ),
     Xyz( -1218622.5263463706, -3183540.254301466, 6339764.146662471 ),
     Xyz( -1242026.6953311013, -3207775.60402386, 6323021.958184356 ),
     Xyz( -1265415.600383901, -3231908.9227085, 6306111.009964837 ),
     Xyz( -1288788.5469142562, -3255939.5814193976, 6289031.751289762 ),
     Xyz( -1312144.8402787237, -3279866.9544247002, 6271784.635936864 ),
     Xyz( -1335483.785802573, -3303690.4192133686, 6254370.1221641125 ),
     Xyz( -1358804.6887996262, -3327409.35651198, 6236788.672698114 ),
     Xyz( -1382106.854593696, -3351023.150300923, 6219040.754722477 ),
     Xyz( -1405389.5885388912, -3374531.187831417, 6201126.839865781 ),
     Xyz( -1428652.1960403258, -3397932.859641338, 6183047.404189825 ),
     Xyz( -1451893.982575499, -3421227.5595720466, 6164802.928177144 ),
     Xyz( -1475114.2537148553, -3444414.6847839793, 6146393.89671919 ),
     Xyz( -1498312.3151420765, -3467493.6357735023, 6127820.79910364 ),
     Xyz( -1521487.4726755605, -3490463.816387996, 6109084.129002338 ),
     Xyz( -1544639.0322891474, -3513324.633842771, 6090184.384458161 ),
     Xyz( -1567766.3001326374, -3536075.498736092, 6071122.067872859 ),
     Xyz( -1590868.5825533406, -3558715.8250652854, 6051897.685993837 ),
     Xyz( -1613945.186116383, -3581245.030242003, 6032511.749901592 ),
     Xyz( -1636995.4176257001, -3603662.5351083335, 6012964.774996256 ),
     Xyz( -1660018.5841454417, -3625967.763951614, 5993257.280984711 ),
     Xyz( -1683013.9930203129, -3648160.144520223, 5973389.7918671 ),
     Xyz( -1705980.9518964496, -3670239.108038289, 5953362.835923841 ),
     Xyz( -1728918.7687436193, -3692204.0892215916, 5933176.945701197 ),
     Xyz( -1751826.7518741698, -3714054.5262916386, 5912832.657998826 ),
     Xyz( -1774704.2099659261, -3735789.8609912926, 5892330.513855056 ),
     Xyz( -1797550.4520818419, -3757409.53859949, 5871671.058533401 ),
     Xyz( -1820364.7876917417, -3778913.007945601, 5850854.841508604 ),
     Xyz( -1843146.526692978, -3800299.7214243915, 5829882.416452431 ),
     Xyz( -1865894.979431592, -3821569.1350103035, 5808754.3412195025 ),
     Xyz( -1888609.4567230665, -3842720.7082723165, 5787471.177832793 ),
     Xyz( -1911289.269873788, -3863753.9043875355, 5766033.492469443 ),
     Xyz( -1933933.730701718, -3884668.190156211, 5744441.855445823 ),
     Xyz( -1956542.15155721, -3905463.0360151194, 5722696.841203334 ),
     Xyz( -1979113.845344754, -3926137.9160519657, 5700799.02829314 ),
     Xyz( -2001648.1255435436, -3946692.308019128, 5678748.999361457 ),
     Xyz( -2024144.3062281935, -3967125.693347638, 5656547.3411345435 ),
     Xyz( -2046601.7020904357, -3987437.5571605302, 5634194.644403504 ),
     Xyz( -2069019.6284599053, -4007627.3882866413, 5611691.504008971 ),
     Xyz( -2091397.401324741, -4027694.679274182, 5589038.518825836 ),
     Xyz( -2113734.337353439, -4047638.9264036934, 5566236.291747675 ),
     Xyz( -2136029.7539149057, -4067459.6297017396, 5543285.429671292 ),
     Xyz( -2158282.9691005587, -4087156.292953853, 5520186.543480622 ),
     Xyz( -2180493.3017446143, -4106728.423717198, 5496940.248031541 ),
     Xyz( -2202660.071444846, -4126175.533334489, 5473547.162135268 ),
     Xyz( -2224782.5985846007, -4145497.136945815, 5450007.908542629 ),
     Xyz( -2246860.2043533963, -4164692.753501481, 5426323.113927977 ),
     Xyz( -2268892.210767099, -4183761.905775169, 5402493.408872791 ),
     Xyz( -2290877.940690178, -4202704.120375942, 5378519.427849161 ),
     Xyz( -2312816.7178562405, -4221518.927760608, 5354401.809203497 ),
     Xyz( -2334707.866888154, -4240205.862246447, 5330141.195139851 ),
     Xyz( -2356550.713320604, -4258764.462022715, 5305738.231703072 ),
     Xyz( -2378344.5836198595, -4277194.269162962, 5281193.56876229 ),
     Xyz( -2400088.805205314, -4295494.8296371065, 5256507.8599935025 ),
     Xyz( -2421782.706470257, -4313665.69332293, 5231681.7628629245 ),
     Xyz( -2443425.6168025285, -4331706.414018014, 5206715.938609732 ),
     Xyz( -2465016.86660575, -4349616.5494512785, 5181611.052228695 ),
     Xyz( -2486555.7873206423, -4367395.661294207, 5156367.772452767 ),
     Xyz( -2508041.7114448408, -4385043.3151725, 5130986.771735882 ),
     Xyz( -2529473.9725549337, -4402559.080677286, 5105468.726234819 ),
     Xyz( -2550851.905327075, -4419942.531375545, 5079814.315792164 ),
     Xyz( -2572174.8455565874, -4437193.244822449, 5054024.223918062 ),
     Xyz( -2593442.1301807193, -4454310.802570951, 5028099.13777233 ),
     Xyz( -2614653.0972984107, -4471294.79018311, 5002039.748146579 ),
     Xyz( -2635807.0861908672, -4488144.797240858, 4975846.74944603 ),
     Xyz( -2656903.4373430857, -4504860.417356288, 4949520.839671109 ),
     Xyz( -2677941.492464617, -4521441.248181641, 4923062.720399543 ),
     Xyz( -2698920.5945089613, -4537886.891420836, 4896473.096767416 ),
     Xyz( -2719840.0876962706, -4554196.952838382, 4869752.677450765 ),
     Xyz( -2740699.3175328453, -4570371.042269835, 4842902.174647168 ),
     Xyz( -2761497.630831701, -4586408.773632018, 4815922.304056815 ),
     Xyz( -2782234.3757342007, -4602309.764932338, 4788813.784863521 ),
     Xyz( -2802908.901729705, -4618073.638279081, 4761577.339715744 ),
     Xyz( -2823520.559676703, -4633700.01989017, 4734213.694708046 ),
     Xyz( -2844068.701823615, -4649188.540103241, 4706723.579361066 ),
     Xyz( -2864552.681828418, -4664538.83338481, 4679107.726603077 ),
     Xyz( -2884971.854780364, -4679750.538339306, 4651366.872749997 ),
     Xyz( -2905325.57721976, -4694823.29771824, 4623501.7574862605 ),
     Xyz( -2925613.2071589273, -4709756.758429186, 4595513.123844939 ),
     Xyz( -2945834.104101677, -4724550.571544568, 4567401.7181886975 ),
     Xyz( -2965987.6290653697, -4739204.392310337, 4539168.290189018 ),
     Xyz( -2986073.1445995416, -4753717.880154609, 4510813.592807406 ),
     Xyz( -3006090.014807606, -4768090.698696103, 4482338.382274553 ),
     Xyz( -3026037.6053671627, -4782322.515752166, 4453743.418070593 ),
     Xyz( -3045915.283548921, -4796413.003347437, 4425029.462905353 ),
     Xyz( -3065722.4182383926, -4810361.837721911, 4396197.282697161 ),
     Xyz( -3085458.3799558575, -4824168.699338229, 4367247.6465533655 ),
     Xyz( -3105122.5408758186, -4837833.272890493, 4338181.3267493155 ),
     Xyz( -3124714.2748485683, -4851355.247310708, 4308999.098708213 ),
     Xyz( -3144232.957418829, -4864734.31577768, 4279701.740979985 ),
     Xyz( -3163677.9658465707, -4877970.175723655, 4250290.035220985 ),
     Xyz( -3183048.679127291, -4891062.528841637, 4220764.766172966 ),
     Xyz( -3202344.4780117115, -4904011.081092819, 4191126.7216420663 ),
     Xyz( -3221564.745025766, -4916815.5427135285, 4161376.692477971 ),
     Xyz( -3240708.864490824, -4929475.628222084, 4131515.4725525794 ),
     Xyz( -3259776.222543116, -4941991.056425844, 4101543.858738925 ),
     Xyz( -3278766.2071536654, -4954361.550427724, 4071462.6508899573 ),
     Xyz( -3297678.208149256, -4966586.837632204, 4041272.651816923 ),
     Xyz( -3316511.617230272, -4978666.649752823, 4010974.667268055 ),
     Xyz( -3335265.8279920355, -4990600.722817487, 3980569.50590691 ),
     Xyz( -3353940.2359437775, -5002388.797175032, 3950057.97929078 ),
     Xyz( -3372534.238528614, -5014030.617501112, 3919440.9018488205 ),
     Xyz( -3391047.235142572, -5025525.932804433, 3888719.0908602937 ),
     Xyz( -3409478.6271550255, -5036874.496431696, 3857893.3664327823 ),
     Xyz( -3427827.817927375, -5048076.0660743, 3826964.551479699 ),
     Xyz( -3446094.212833175, -5059130.403772795, 3795933.4716987466 ),
     Xyz( -3464277.219277144, -5070037.275922805, 3764800.95554947 ),
     Xyz( -3482376.2467148644, -5080796.453280057, 3733567.8342308807 ),
     Xyz( -3500390.706671577, -5091407.710965694, 3702234.94165928 ),
     Xyz( -3518320.0127616106, -5101870.828471145, 3670803.1144458144 ),
     Xyz( -3536163.5807086183, -5112185.589662435, 3639273.1918736254 ),
     Xyz( -3553920.8283633264, -5122351.782785513, 3607646.015875748 ),
     Xyz( -3571591.175722938, -5132369.200470771, 3575922.4310121816 ),
     Xyz( -3589174.0449510105, -5142237.639737022, 3544103.284446897 ),
     Xyz( -3606668.860395944, -5151956.901996064, 3512189.4259251645 ),
     Xyz( -3624075.048609258, -5161526.793056917, 3480181.7077511065 ),
     Xyz( -3641392.038365792, -5170947.123129769, 3448080.984763475 ),
     Xyz( -3658619.2606820157, -5180217.706829235, 3415888.1143140397 ),
     Xyz( -3675756.148834127, -5189338.363179492, 3383603.95624302 ),
     Xyz( -3692802.138377817, -5198308.915616355, 3351229.3728570435 ),
     Xyz( -3709756.6671660957, -5207129.191991994, 3318765.228904888 ),
     Xyz( -3726619.1753686913, -5215799.024577385, 3286212.3915544813 ),
     Xyz( -3743389.1054900773, -5224318.250065767, 3253571.730369655 ),
     Xyz( -3760065.902387627, -5232686.7095763255, 3220844.117286058 ),
     Xyz( -3776649.0132914283, -5240904.248655739, 3188030.4265879774 ),
     Xyz( -3793137.887820886, -5248970.717282516, 3155131.5348842856 ),
     Xyz( -3809531.9780039308, -5256885.969868798, 3122148.321085042 ),
     Xyz( -3825830.738295387, -5264649.865262934, 3089081.666377283 ),
     Xyz( -3842033.6255953177, -5272262.266751615, 3055932.45420137 ),
     Xyz( -3858140.099265935, -5279723.042063126, 3022701.570226734 ),
     Xyz( -3874149.621150973, -5287032.063368311, 2989389.9023281815 ),
     Xyz( -3890061.6555931936, -5294189.2072830275, 2955998.3405613923 ),
     Xyz( -3905875.669451777, -5301194.354870277, 2922527.7771389927 ),
     Xyz( -3921591.1321209953, -5308047.391641392, 2888979.1064060507 ),
     Xyz( -3937207.515548003, -5314748.207557411, 2855353.2248159987 ),
     Xyz( -3952724.294249286, -5321296.697031538, 2821651.030906128 ),
     Xyz( -3968140.9453299334, -5327692.758929189, 2787873.4252730333 ),
     Xyz( -3983456.948499873, -5333936.296570193, 2754021.310548096 ),
     Xyz( -3998671.7860923354, -5340027.2177289, 2720095.5913730627 ),
     Xyz( -4013784.943080847, -5345965.434635447, 2686097.174375331 ),
     Xyz( -4028795.9070961187, -5351750.863977021, 2652026.9681428527 ),
     Xyz( -4043704.16844451, -5357383.426897088, 2617885.883200163 ),
     Xyz( -4058509.22012438, -5362863.048997018, 2583674.831982651 ),
     Xyz( -4073210.557842377, -5368189.660336675, 2549394.7288121716 ),
     Xyz( -4087807.6800328554, -5373363.195432958, 2515046.4898718726 ),
     Xyz( -4102300.0878727296, -5378383.593261234, 2480631.0331815924 ),
     Xyz( -4116687.28529879, -5383250.797255264, 2446149.278572011 ),
     Xyz( -4130968.779025632, -5387964.755305798, 2411602.147660204 ),
     Xyz( -4145144.078561299, -5392525.419761164, 2376990.5638241814 ),
     Xyz( -4159212.696223326, -5396932.747427229, 2342315.4521775553 ),
     Xyz( -4173174.1471576, -5401186.699564977, 2307577.7395443427 ),
     Xyz( -4187027.9493528153, -5405287.241891185, 2272778.3544337666 ),
     Xyz( -4200773.623657173, -5409234.3445774885, 2237918.22701441 ),
     Xyz( -4214410.69379613, -5413027.9822479775, 2202998.289089227 ),
     Xyz( -4227938.686386714, -5416668.133979659, 2168019.4740697113 ),
     Xyz( -4241357.130954634, -5420154.7833003, 2132982.7169504394 ),
     Xyz( -4254665.559951257, -5423487.918186243, 2097888.9542834307 ),
     Xyz( -4267863.508767536, -5426667.531062325, 2062739.1241527777 ),
     Xyz( -4280950.515751731, -5429693.618798989, 2027534.1661481415 ),
     Xyz( -4293926.122225119, -5432566.182710127, 1992275.0213397779 ),
     Xyz( -4306789.872495621, -5435285.228552774, 1956962.6322527146 ),
     Xyz( -4319541.313876759, -5437850.766522562, 1921597.9428401531 ),
     Xyz( -4332179.996700789, -5440262.811252991, 1886181.8984584939 ),
     Xyz( -4344705.474334553, -5442521.381812947, 1850715.4458407236 ),
     Xyz( -4357117.303196193, -5444626.5017029485, 1815199.5330706213 ),
     Xyz( -4369415.042769218, -5446578.198853366, 1779635.1095568147 ),
     Xyz( -4381598.255616991, -5448376.505622086, 1744023.1260069872 ),
     Xyz( -4393666.507400429, -5450021.458789605, 1708364.534401047 ),
     Xyz( -4405619.366890818, -5451513.099557543, 1672660.2879655517 ),
     Xyz( -4417456.405985008, -5452851.473545162, 1636911.3411472945 ),
     Xyz( -4429177.199721722, -5454036.630784707, 1601118.6495873346 ),
     Xyz( -4440781.326294298, -5455068.625719637, 1565283.170094218 ),
     Xyz( -4452268.367066855, -5455947.517199462, 1529405.860618418 ),
     Xyz( -4463637.90658848, -5456673.368476489, 1493487.6802251143 ),
     Xyz( -4474889.532606848, -5457246.247202261, 1457529.5890687283 ),
     Xyz( -4486022.836084345, -5457666.22542226, 1421532.5483657392 ),
     Xyz( -4497037.411210703, -5457933.379572852, 1385497.5203687549 )
   )

  "an OrbitalTrajectory" should "compute the nearest point with known data" in {
    val trj = OrbitalTrajectory.from(data5, DateTime(2020, 8, 20, 9, 52, 0, 0, DateTime.utcId), Seconds(5))
    trj.toGroundTrack()

    val pos = GeoPosition.fromDegreesAndMeters(37.062199, -122.219063, 0)
    val p = Datum.wgs84ToECEF(pos).toXyz

    var cp = trj.findClosestPoint(p)
    var cpPos = Datum.ecefToWGS84(cp)
    println("---- closest trajectory point")
    println(s"cross-track point ecef:  $cp")
    println(s"cross-track point wgs84: $cpPos")

    cp = trj.findClosestGroundTrackPoint(p)
    cpPos = Datum.ecefToWGS84(cp)
    println("---- closest groundtrack point")
    println(s"cross-track point ecef:  $cp")
    println(s"cross-track point wgs84: $cpPos")

  }
}
