<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8"/>
        <title>RACE</title>

        <link href="../race-html.css" rel="stylesheet"/>
    </head>

    <body>
        <div class="navbar">
            <div class=""banner>
                <a href="index.html" ><img class="logo" src="../images/race128.png"></a>
                <p class="doctitle">RACE Manual</p>
            </div>
            <br/>
            <div class="toc">
                <p class="title">Project Links</p>
                <ul>
                    <li><span class="toc level2"><a href="https://github.com/NASARace/race.git">Repository</a></span></li>
                    <li><span class="toc level2"><a href="http://nasarace.github.io/race">Website</a></span></li>
                </ul>
            </div>
            <div class="pagetoc">
                <div class="toc">
                  <p class="title">Page</p>
                  <ul>
                    <li>
                      <p class="toc level1"><a href="#analysis">Analysis</a></p>
                      <ul>
                        <li><span class="toc level2"><a href="#order-anomalies">Order Anomalies</a></span></li>
                        <li><span class="toc level2"><a href="#duration-anomalies">Duration Anomalies</a></span></li>
                      </ul>
                    </li>
                  </ul>
                </div>
            </div>
            <div class="globaltoc">
                <div class="toc">
                  <p class="title">Site</p>
                  <ul>
                    <li><span class="toc level1"><a href="../index.html">About RACE</a></span></li>
                    <li><span class="toc level1"><a href="../project-log.html">Project Log</a></span></li>
                    <li>
                      <p class="toc level1">Installing RACE</p>
                      <ul>
                        <li><span class="toc level2"><a href="../installation/prerequisites.html">Prerequisites</a></span></li>
                        <li><span class="toc level2"><a href="../installation/download.html">Downloading RACE</a></span></li>
                        <li><span class="toc level2"><a href="../installation/build.html">Building RACE</a></span></li>
                        <li><span class="toc level2"><a href="../installation/pitfalls.html">Installation Pitfalls</a></span></li>
                        <li><span class="toc level2"><a href="../installation/osx.html">OS X Specifics</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1">Using RACE</p>
                      <ul>
                        <li><span class="toc level2"><a href="../usage/running.html">How to Run RACE</a></span></li>
                        <li><span class="toc level2"><a href="../usage/configuration.html">RACE Configuration</a></span></li>
                        <li><span class="toc level2"><a href="../usage/encryption.html">Using Encrypted Configurations</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1"><a href="../actors.html">Actors</a></p>
                      <ul>
                        <li><span class="toc level2"><a href="../actors.html#actor-components-and-properties">Actor Components and Properties</a></span></li>
                        <li><span class="toc level2"><a href="../actors.html#actor-communication">Actor Communication</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1">RACE Design</p>
                      <ul>
                        <li><span class="toc level2"><a href="overview.html">Design Overview</a></span></li>
                        <li><span class="toc level2"><a href="configuration.html">Runtime Configuration</a></span></li>
                        <li><span class="toc level2"><a href="raceactors.html">RaceActors</a></span></li>
                        <li><span class="toc level2"><a href="channeltopics.html">ChannelTopics</a></span></li>
                        <li><span class="toc level2"><a href="embedded-objects.html">Embedded Objects</a></span></li>
                        <li><span class="toc level2"><a href="connectivity.html">Connecting External Systems</a></span></li>
                        <li><span class="toc level2"><a href="archive-replay.html">Archive and Replay</a></span></li>
                        <li><span class="toc level2"><a href="worldwind.html">WorldWind Viewer</a></span></li>
                        <li><span class="toc level2"><a href="http-server.html">HttpServer</a></span></li>
                        <li><span class="toc level2 active">Time Series Analysis</span></li>
                        <li><span class="toc level2"><a href="remotelauncher.html">RemoteLauncher</a></span></li>
                        <li><span class="toc level2"><a href="layers-and-modules.html">Layers and Modules</a></span></li>
                        <li><span class="toc level2"><a href="directory-structure.html">Directory Structure</a></span></li>
                        <li><span class="toc level2"><a href="repository.html">Repository Structure</a></span></li>
                        <li><span class="toc level2"><a href="local-build.html">Local Build Configuration</a></span></li>
                        <li><span class="toc level2"><a href="dds.html">RACE and DDS</a></span></li>
                        <li><span class="toc level2"><a href="extproject.html">Using RACE from External Projects</a></span></li>
                        <li><span class="toc level2"><a href="whyscala.html">Why Scala</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1"><a href="../examples.html">RACE Examples</a></p>
                      <ul>
                        <li><span class="toc level2"><a href="../examples.html#basic-examples">Basic Examples</a></span></li>
                        <li><span class="toc level2"><a href="../examples.html#distributed-operation">Distributed Operation</a></span></li>
                        <li><span class="toc level2"><a href="../examples.html#live-data-import">Live Data Import</a></span></li>
                        <li><span class="toc level2"><a href="../examples.html#data-replay">Data Replay</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1">Documentation</p>
                      <ul>
                        <li><span class="toc level2"><a href="../documentation/overview.html">RACE Documentation Overview</a></span></li>
                        <li><span class="toc level2"><a href="../documentation/presentations.html">Available Slide Presentations</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1"><a href="../known-problems.html">Known Problems</a></p>
                      <ul>
                        <li><span class="toc level2"><a href="../known-problems.html#build">Build</a></span></li>
                        <li><span class="toc level2"><a href="../known-problems.html#runtime">Runtime</a></span></li>
                      </ul>
                    </li>
                    <li><span class="toc level1"><a href="../changes.html">Changes</a></span></li>
                    <li><span class="toc level1"><a href="../todo.html">TODO List</a></span></li>
                    <li>
                      <p class="toc level1"><a href="../learning.html">Learning Resources</a></p>
                      <ul>
                        <li><span class="toc level2"><a href="../learning.html#scala">Scala</a></span></li>
                        <li><span class="toc level2"><a href="../learning.html#actors-and-akka">Actors and Akka</a></span></li>
                        <li><span class="toc level2"><a href="../learning.html#sbt">SBT</a></span></li>
                        <li><span class="toc level2"><a href="../learning.html#interactive-scala-akka-and-sbt-learning-environment-and-examples">Interactive Scala, Akka and SBT Learning Environment and Examples</a></span></li>
                        <li><span class="toc level2"><a href="../learning.html#git">Git</a></span></li>
                      </ul>
                    </li>
                    <li><span class="toc level1"><a href="../glossary.html">Glossary</a></span></li>
                  </ul>
                </div>
            </div>
        </div>

        <div class="main">
            <h1 id="time-series-analysis" class="title">Time Series Analysis</h1>
            <p>One of the primary use cases of RACE is to analyze streams of timed events such as flight
            position updates received via <a href="https://www.faa.gov/nextgen/programs/swim/">SWIM</a> XML messages. Typically, such messages bundle updates for any
            number of objects (e.g. flights), each <em>update object</em> contains its own time stamp (e.g. position
            time). Messages are received from the same server through the same network connection and hence
            have a total order over time.</p>
            <p><img class="center scale60" src="../images/ts-analysis.svg" alt="Time Series Analysis"></p>
            <p>Both messages and <em>update objects</em> represent irregular time series that can be analyzed separately
            with respect to</p>
            <ul>
              <li>statistics (such as average and peak rate) and</li>
              <li>anomalies (ordering, syntactic and semantic consistency)</li>
            </ul>
            <p>Analysis results have to support different output formats such as console output, XML files or HTML
            documents.</p>
            <p>Since this applies to a large number of messages and update object types, and needs to be extensible
            in terms of specific message/object type processing, RACE provides generic infrastructure to support
            such analysis and reporting.</p>
            <p><img class="center scale80" src="../images/ts-collect-report.svg" alt="TSStatsCollector and ReportActor"></p>
            <p>This infrastructure revolves around 6 constructs: update objects, <code>TSStatsCollector</code>, <code>TSEntryData</code>,
            <code>TSStatsData</code>, <code>Stats</code> and <code>StatsReporter</code>.</p>
            <p><strong>update object</strong> is just a term for a <code>Dated</code> object we want to reason about (such as <code>FlightPos</code>).</p>
            <p><strong>TSStatsCollector</strong> is typically an actor which is responsible for collecting statistics and
            analysis results for a specific update object type. To that end, it internally uses two generic
            data structures to collect results: <code>TSEntryData</code> and <code>TSStatsData</code>. Both take the
            update object type as a type parameter in order to support specific processing in sub-classes.
            <code>TSStatsCollector</code> itself is a generic type that takes four type parameters:</p>
            <ul>
              <li>K: a key type to identify update objects, which is usually a String (e.g. call sign for flights)</li>
              <li>O: the update object type (e.g. <code>FlightPos</code>)</li>
              <li>E[O]: the concrete <code>TSEntryData</code> type</li>
              <li>S[O,E]: the concrete <code>TSStatsData</code> type</li>
            </ul>
            <p><strong>TSEntryData</strong> is the structure to store analysis data for update object entities (such as the
            flights represented by <code>FlightPos</code> objects). This can involve strictly internal data which is
            only used to periodically compute statistics.</p>
            <p><strong>TSStatsData</strong> is the structure that represents the data to report. This is typically a ephemeral
            data structure that is constantly updated (e.g. number of update objects processed), and is used
            to create invariant snapshots of the reporting data at a configured collection interval.</p>
            <p><strong>Stats</strong> is the invariant report data that is sent out by the TSStatsCollector. In addition to
            the statistics/analysis data itself it contains the time stamp at which the data was taken,
            and a configurable <em>topic</em> name that can be used to identify the particular report.</p>
            <p><strong>StatsReporter</strong> finally is an actor that subscribes to channels on which it receives <code>Stats</code>
            (report) data. The StatsReporter is responsible for creating the actual report, which involves both
            output (e.g. console, HTML) and report type (e.g. TATrackStats) specific formatting.
            Reporting time can be different than collection time. The <code>StatsReporter</code> stores incoming <code>Stats</code>
            objects (which are invariant and have a generation time stamp) under their respective topic. At
            the scheduled report time it generates the output from the received Stats objects by calling the
            abstract <code>report()</code> method that has to be provided by the concrete <code>StatsReporter</code>. This method
            can do the formatting itself, or - typically - use pattern matching on the <code>Stats</code> object types
            to delegate it to respective subtypes such as <code>TATrackStatsCollector</code>.</p>
            
            <h2 id="analysis" class="section">Analysis</h2>
            <p>Off the shelf, RACE includes classes to collect general statistics such as</p>
            <ul>
              <li>total number of entity updates since start</li>
              <li>current number of live entities (e.g. active flights)</li>
              <li>min/max number of live entities since start</li>
              <li>min/max and average update interval since start</li>
            </ul>
            <p>This can also include histogram data if finer update rate information is needed.</p>
            <p>Since the analyzed data represents time series, RACE also provides statistics about a number of
            general temporal anomalies that fall into two categories: order based and duration based</p>
            
            <h3 id="order-anomalies" class="section">Order Anomalies</h3>
            <p>This category refers to the ordering in which update events for the same entity are generated and
            received.</p>
            <p><strong>out-of-order</strong> means events are received in reverse order of creation, i.e. without respective
            precautions clients could overwrite more up-to-date data with older data, or compute negative time
            differences.</p>
            <p><strong>ambiguity</strong> anomalies are cases in which update events have the same time stamp but otherwise
            different data values such as positions. This is more serious because clients usually cannot
            resolve such ambiguities easily.</p>
            <p><strong>duplicates</strong> are cases in which different update events carry the same time stamp and the same
            data. This is normally more a bandwidth problem at the message level, e.g. by reporting the same
            sensor reading twice (e.g. from different stations). Clients still have to be aware of zero time
            deltas in case they compute rates.</p>
            <p><img class="center scale60" src="../images/ts-anomaly-content.svg" alt="Order Based Time Series Anomalies"></p>
            
            <h3 id="duration-anomalies" class="section">Duration Anomalies</h3>
            <p>Such anomalies involve the duration between the time an event was generated (time stamp) and
            the time it is received.</p>
            <p><strong>stale</strong> anomalies are update events that are received at a time when the data is already assumed to
            be outdated</p>
            <p><strong>dropped</strong> anomalies represent cases in which live entities have not been updated for a duration
            that exceeds the expected update interval</p>
            <p><strong>blackout</strong> anomalies are cases where entities that were previously reported as completed
            (e.g. a flight that has landed) re-appear within a given blackout duration, which means either the
            completion event was erroneous, or there is a potential problem with the re-use of entity keys such
            as call signs or track numbers.</p>
            <p><img class="center scale60" src="../images/ts-anomaly-temp.svg" alt="Duration Based Time Series Anomalies"></p>
        </div>

    </body>
</html>