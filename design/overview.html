<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8"/>
        <title>RACE</title>

        <link href="../race-html.css" rel="stylesheet"/>
    </head>

    <body>
        <div class="navbar">
            <div class=""banner>
                <a href="index.html" ><img class="logo" src="../images/race128.png"></a>
                <p class="doctitle">RACE Manual</p>
            </div>
            <br/>
            <div class="toc">
                <p class="title">Project Links</p>
                <ul>
                    <li><span class="toc level2"><a href="https://github.com/NASARace/race.git">Repository</a></span></li>
                    <li><span class="toc level2"><a href="http://nasarace.github.io/race">Website</a></span></li>
                </ul>
            </div>
            <div class="pagetoc">
                <div class="toc">
                  <p class="title">Page</p>
                  <ul>
                    <li><span class="toc level1"><a href="#main-race-constructs">Main RACE Constructs</a></span></li>
                    <li><span class="toc level1"><a href="#configuration">Configuration</a></span></li>
                    <li><span class="toc level1"><a href="#deterministic-runtime-sequences">Deterministic Runtime Sequences</a></span></li>
                    <li><span class="toc level1"><a href="#on-demand-data-flow-control-for-publish-subscribe-channels">On-Demand Data Flow Control for Publish-Subscribe Channels</a></span></li>
                    <li><span class="toc level1"><a href="#remoting">Remoting</a></span></li>
                  </ul>
                </div>
            </div>
            <div class="globaltoc">
                <div class="toc">
                  <p class="title">Site</p>
                  <ul>
                    <li><span class="toc level1"><a href="../index.html">About RACE</a></span></li>
                    <li><span class="toc level1"><a href="../project-log.html">Project Log</a></span></li>
                    <li>
                      <p class="toc level1">Installing RACE</p>
                      <ul>
                        <li><span class="toc level2"><a href="../installation/prerequisites.html">Prerequisites</a></span></li>
                        <li><span class="toc level2"><a href="../installation/download.html">Downloading RACE</a></span></li>
                        <li><span class="toc level2"><a href="../installation/build.html">Building RACE</a></span></li>
                        <li><span class="toc level2"><a href="../installation/osx.html">OS X Specifics</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1">Using RACE</p>
                      <ul>
                        <li><span class="toc level2"><a href="../usage/running.html">How to Run RACE</a></span></li>
                        <li><span class="toc level2"><a href="../usage/configuration.html">RACE Configuration</a></span></li>
                        <li><span class="toc level2"><a href="../usage/encryption.html">Using Encrypted Configurations</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1"><a href="../actors.html">Actors</a></p>
                      <ul>
                        <li><span class="toc level2"><a href="../actors.html#actor-components-and-properties">Actor Components and Properties</a></span></li>
                        <li><span class="toc level2"><a href="../actors.html#actor-communication">Actor Communication</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1">RACE Design</p>
                      <ul>
                        <li><span class="toc level2 active">Design Overview</span></li>
                        <li><span class="toc level2"><a href="configuration.html">Runtime Configuration</a></span></li>
                        <li><span class="toc level2"><a href="raceactors.html">RaceActors</a></span></li>
                        <li><span class="toc level2"><a href="channeltopics.html">ChannelTopics</a></span></li>
                        <li><span class="toc level2"><a href="worldwind.html">WorldWind Viewer</a></span></li>
                        <li><span class="toc level2"><a href="remotelauncher.html">RemoteLauncher</a></span></li>
                        <li><span class="toc level2"><a href="layers-and-modules.html">Layers and Modules</a></span></li>
                        <li><span class="toc level2"><a href="directory-structure.html">Directory Structure</a></span></li>
                        <li><span class="toc level2"><a href="repository.html">Repository Structure</a></span></li>
                        <li><span class="toc level2"><a href="local-build.html">Local Build Configuration</a></span></li>
                        <li><span class="toc level2"><a href="dds.html">RACE and DDS</a></span></li>
                        <li><span class="toc level2"><a href="extproject.html">Using RACE from External Projects</a></span></li>
                        <li><span class="toc level2"><a href="whyscala.html">Why Scala</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1"><a href="../examples.html">RACE Examples</a></p>
                      <ul>
                        <li><span class="toc level2"><a href="../examples.html#basic-examples">Basic Examples</a></span></li>
                        <li><span class="toc level2"><a href="../examples.html#distributed-operation">Distributed Operation</a></span></li>
                        <li><span class="toc level2"><a href="../examples.html#live-data-import">Live Data Import</a></span></li>
                        <li><span class="toc level2"><a href="../examples.html#data-replay">Data Replay</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1">Documentation</p>
                      <ul>
                        <li><span class="toc level2"><a href="../documentation/overview.html">RACE Documentation Overview</a></span></li>
                        <li><span class="toc level2"><a href="../documentation/presentations.html">Available Slide Presentations</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1"><a href="../learning.html">Learning Resources</a></p>
                      <ul>
                        <li><span class="toc level2"><a href="../learning.html#scala">Scala</a></span></li>
                        <li><span class="toc level2"><a href="../learning.html#actors-and-akka">Actors and Akka</a></span></li>
                        <li><span class="toc level2"><a href="../learning.html#sbt">SBT</a></span></li>
                        <li><span class="toc level2"><a href="../learning.html#interactive-scala-akka-and-sbt-learning-environment-and-examples">Interactive Scala, Akka and SBT Learning Environment and Examples</a></span></li>
                        <li><span class="toc level2"><a href="../learning.html#git">Git</a></span></li>
                      </ul>
                    </li>
                    <li><span class="toc level1"><a href="../glossary.html">Glossary</a></span></li>
                  </ul>
                </div>
            </div>
        </div>

        <div class="main">
            <h1 id="design-overview" class="title">Design Overview</h1>
            <p>While RACE heavily depends on its Akka basis, RACE adds its own application model and actor types in
            order to support</p>
            <ul>
              <li>fully runtime configurable systems</li>
              <li>deterministic system initialization and termination</li>
              <li>on-demand data flow control</li>
              <li>seamless communication between different RACE processes</li>
            </ul>
            <p>Although fully compatible with normal Akka components, RACE instances are specialized Akka
            applications. Moreover, while RACE instances can run as standalone processes, the application model
            supports and encourages distributed operation, both for reasons of scalability and localized access
            to external resources.</p>
            <p>This section contains a high level description of the main RACE components and how they contribute
            to the goals mentioned above. We start by looking at the main building blocks of RACE, from
            the inside out.</p>
            <p><img class="center scale60" src="../images/race-overview-2.svg" alt="RACE overview"></p>
            
            <h2 id="main-race-constructs" class="section">Main RACE Constructs</h2>
            <p><strong>RaceActors</strong> are the most basic RACE component. They are specialized Akka actors, implementing
            a common state model (creation, initialization, start, pause/resume, termination). Among other
            aspects, the common RACE type hierarchy supports instantiation and parameterization of RaceActors
            from configuration data, separation of system- and user- message processing, and access to local and
            global bus channels.</p>
            <p><strong>Master Actor</strong> is the supervisor of all RaceActors running within a RACE process. The master
            is responsible for lifetime monitoring and control of all configured RaceActors. Each lifetime
            phase (corresponding to RaceActor states) is processed sequentially by the master, according to
            the order in which actors are specified in the configuration. Each phase is only entered after the
            previous one succeeded, and within each phase actors are only processed after their successors
            successfully completed this step.</p>
            <p><strong>RaceActorSystem</strong> is the construct that aggregates master, RaceActors and shared resources
            such as the event bus and a system clock. RaceActorSystem objects also manage associated Akka
            resources (Akka ActorSystem, logging etc.). Consequently, most of the RaceActorSystem processing
            takes place during initialization and termination, such as creating the master actor during
            RaceActorSystem initialization.</p>
            <p><strong>RACE Drivers</strong> are the main classes that start and control RACE. They are mostly responsible
            for obtaining the configuration data and then instantiating a RaceActorSystem with this configuration.
            RACE drivers are also the high level interface towards the user, providing commands to start, inspect
            and terminate RACE as a whole, which is done by calling respective RaceActorSystem functions.
            RACE contains a number of drivers, supporting user interaction through a text console, graphical
            user interfaces and server interfaces. The driver layer also contains support to start remote
            RACE instances without direct user input (e.g. for cloud deployment).</p>
            <p>Armed with a basic understanding of main RACE constructs, we can now proceed looking at how these
            components are used to achieve our high level goals.</p>
            
            <h2 id="configuration" class="section">Configuration</h2>
            <p>RACE is not a monolithic application. The various RACE drivers are generic applications that all
            expect a configuration file (or object) that specifies the actors which partake in a concrete RACE
            instance at runtime. To define such configurations, RACE uses a single, human readable text file
            format (<a href="https://github.com/typesafehub/config/blob/master/HOCON.md">HOCON</a>). The main content of a configuration file is a ordered list of canonical RaceActor
            specification elements, each one containing name, type, connections and type-specific parameters.
            Those elements are passed into the respective RaceActor constructors.</p>
            <p>Please refer to the <a href="configuration.html#runtime-configuration">Runtime Configuration</a> section for more details.</p>
            
            <h2 id="deterministic-runtime-sequences" class="section">Deterministic Runtime Sequences</h2>
            <p>RACE is based on a state model that calls out separate creation, initialization, start
            and termination phases. While Akka actors normally are supposed to avoid sequential processing
            in favor of fully asynchronous operation, this makes it harder to define dependencies between actors.
            Typical RACE applications use <a href="raceactors.html#raceactors">RaceActors</a> to connect to external resources (data feeds and consumers),
            and hence do have such dependencies between actors. RACE therefore enforces sequential system
            construction and destruction by means of the master actor, based on the order in which RaceActors are
            defined in their respective RACE configuration file.</p>
            <p>In addition to initialization during actor construction, RACE also features a separate initialization
            phase after all actors have been constructed, which is mostly used to connect and configure remote
            RaceActors.</p>
            <p>All this is in support of deterministic system behavior, which is a critical property for
            simulations that should produce similar results under similar circumstances.</p>
            
            <h2 id="on-demand-data-flow-control-for-publish-subscribe-channels" class="section">On-Demand Data Flow Control for Publish-Subscribe Channels</h2>
            <p><a href="raceactors.html#raceactors">RaceActors</a> typically communicate through a anonymous publish/subscribe mechanism, i.e. producer
            actors are connected to consumer actors by means of abstract <em>bus channels</em> that are specified as
            path-like strings such as <code>/flights/positions</code>. Each <a href="raceactors.html#raceactor">RaceActor</a> is responsible for selecting what
            information from a given channel it processes, which can be conveniently and safely programmed with
            Scala&#39;s built-in <a href="https://matt.aimonetti.net/posts/2012/09/20/what-is-scala-pattern-matching/">Pattern Matching</a> support. Bus channels use a hierarchical, path-like naming
            scheme, which allows pattern based subscriptions.</p>
            <p>While bus channels describe the static connections between actors, RACE also supports on-demand
            flow control through fully transitive <a href="channeltopics.html#channeltopics">ChannelTopics</a>. This mechanism allows to turn on/off high
            volume message processing that should only take place if there are active consumers, without
            having to know <em>a priori</em> which actor is the original data source or requester.</p>
            
            <h2 id="remoting" class="section">Remoting</h2>
            <p>RACE promotes distributed operation. Based on Akka&#39;s <a href="http://doc.akka.io/docs/akka/current/scala/remoting.html">Actor Remoting</a>, RACE provides support
            for full <a href="http://doc.akka.io/docs/akka/current/general/remoting.html#remoting">Location Transparency</a> of RaceActors, which means that actors can be assigned
            to different RACE instances strictly by means of configuration, without having to modify
            the respective actor code.</p>
            <p>Remoting encompasses two aspects: (a) specification of where the actor is going to physically
            reside, and (b) a mechanism to let remote actors seamlessly communicate with local actors. The
            first aspect is implemented by means of a <code>remote</code> configuration option that allows the
            master actor to locate/start the remote actor. The seamless communication is achieved through
            the master actor initialization phase that connects participating RACE instances, and through
            the RaceActor publish/subscribe interface, which distinguishes between local and global bus by means
            of channel names (e.g. <code>/local/x</code>)</p>
        </div>

    </body>
</html>