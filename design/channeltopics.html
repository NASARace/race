<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8"/>
        <title>RACE</title>

        <link href="../race-html.css" rel="stylesheet"/>
    </head>

    <body>
        <div class="navbar">
            <div class=""banner>
                <a href="index.html" ><img class="logo" src="../images/race128.png"></a>
                <p class="doctitle">RACE Manual</p>
            </div>
            <br/>
            <div class="globaltoc">
                <div class="toc">
                  <p class="title">Contents</p>
                  <ul>
                    <li><span class="toc level1"><a href="../about.html">About RACE</a></span></li>
                    <li>
                      <p class="toc level1">Installing RACE</p>
                      <ul>
                        <li><span class="toc level2"><a href="../installation/prerequisites.html">Prerequisites</a></span></li>
                        <li><span class="toc level2"><a href="../installation/download.html">Downloading RACE</a></span></li>
                        <li><span class="toc level2"><a href="../installation/build.html">Building RACE</a></span></li>
                        <li><span class="toc level2"><a href="../installation/osx.html">OS X Specifics</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1">Using RACE</p>
                      <ul>
                        <li><span class="toc level2"><a href="../usage/running.html">How to Run RACE</a></span></li>
                        <li><span class="toc level2"><a href="../usage/configuration.html">RACE Configuration</a></span></li>
                        <li><span class="toc level2"><a href="../usage/encryption.html">Using Encrypted Configurations</a></span></li>
                        <li><span class="toc level2"><a href="../usage/examples.html">RACE examples</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1"><a href="../actors.html">Actors</a></p>
                      <ul>
                        <li><span class="toc level2"><a href="../actors.html#actor-components-and-properties">Actor Components and Properties</a></span></li>
                        <li><span class="toc level2"><a href="../actors.html#actor-communication">Actor Communication</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1">RACE Design</p>
                      <ul>
                        <li><span class="toc level2"><a href="overview.html">Design Overview</a></span></li>
                        <li><span class="toc level2"><a href="configuration.html">Runtime Configuration</a></span></li>
                        <li><span class="toc level2"><a href="raceactors.html">RaceActors</a></span></li>
                        <li><span class="toc level2 active">ChannelTopics</span></li>
                        <li><span class="toc level2"><a href="worldwind.html">WorldWind Viewer</a></span></li>
                        <li><span class="toc level2"><a href="remotelauncher.html">RemoteLauncher</a></span></li>
                        <li><span class="toc level2"><a href="layers-and-modules.html">Layers and Modules</a></span></li>
                        <li><span class="toc level2"><a href="directory-structure.html">Directory Structure</a></span></li>
                        <li><span class="toc level2"><a href="whyscala.html">Why Scala</a></span></li>
                      </ul>
                    </li>
                    <li><span class="toc level1"><a href="../glossary.html">Glossary</a></span></li>
                  </ul>
                </div>
            </div>
            <div class="pagetoc">
                <div class="toc">
                  <p class="title">Page</p>
                </div>
            </div>
            <div class="toc">
                <p class="title">Project Links</p>
                <ul>
                    <li><span class="toc level2"><a href="https://github.com/NASARace/race.git">Repository</a></span></li>
                    <li><span class="toc level2"><a href="https://NASARace/github.io/race">Website</a></span></li>
                </ul>
            </div>
        </div>

        <div class="main">
            <h1 id="channeltopics" class="title">ChannelTopics</h1>
            <p>ChannelTopics are a mechanism to control data flow along bus channels. While the channels can be
            seen as the static pipes between actors, ChannelTopics can be thought of as the valves that turn
            on/off data flow along those pipes on demand. The rationale behind channel topic requests is that
            high volume messages/data should only proliferate through a RACE system if there are active clients
            for that data, which otherwise should be filtered at the system boundaries.</p>
            <p>The two traits that implement the mechanism are <code>ChannelTopicSubscriber</code> (as the
            requesting consumer) and <code>ChannelTopicProvider</code> (as the producer). Both define a protocol that
            works fully transitive and asynchronous, i.e. providers can in turn request their own ChannelTopics
            when they receive a request, and respond once they got their requests answered. A single ChannelTopic
            request can therefore trigger a whole set of (different but related) requests upstream.</p>
            <p>Request topics are generic <code>Option[Any]</code> objects, i.e. their values can be either</p>
            <ul>
              <li><code>None</code> - indicating requests that refer to whole channels</li>
              <li><code>Some(object)</code> - which allows the use of application specific objects to further elaborate requests</li>
            </ul>
            <p>It is up to the ChannelTopicProvider to pattern match request topics it will serve.</p>
            <p><img class="center scale70" src="../images/race-channeltopics.svg" alt="RACE overview"></p>
            <p>At each level, requests are handled in four steps</p>
            <ul>
              <li>the request itself by the <code>ChannelTopicSubscriber</code> actor</li>
              <li>a response by one or more <code>ChannelTopicProvider</code> actors</li>
              <li>an accept by the subscriber to the selected provider</li>
              <li>data publishing of the accepted provider</li>
            </ul>
            <p>Conversely, the subscriber announces to the selected provider once it does not need the data
            anymore. <code>ChannelTopicProviders</code> keep track of their clients, and stop producing one the last
            client for a topic has de-registered.</p>
            <p>The <code>ChannelTopicSubscriber</code> API mainly consists of five methods:</p>
            <ul>
              <li>a system provided <code>request(channel,topic)</code> to request a topic for a single channel</li>
              <li>a system provided <code>requestTopic(topic)</code> for requests that pertain to all subscribed channels</li>
            </ul>
            <p>- an overridable <code>isResponseAccepted(response)</code> which returns true to select a responding provider
            (he default <code>isResponseAccepted()</code> implementation just picks the first responding provider)
            - a system provided <code>releaseChannelTopic(channelTopic)</code> to release a single channel/topic subscriptions
            - a system provided <code>releaseAll</code> to release all open channel/topic subscriptions</p>
            <p>The <code>ChannelTopicProvider</code> API has three methods:</p>
            <p>- a <code>isRequestAccepted(request)</code> that has to be defined by the concrete <code>ChannelTopicProvider</code>
            (there is no default), returning true for accepted responses
            - a overridable <code>gotAccept(accept)</code> that is automatically called upon receiving an accept
            - a overridable <code>gotRelease(release)</code>, automatically called upon receiving a release</p>
            <p>Providers that are also requesters by themselves have to mix in <code>TransitiveChannelTopicProvider</code>
            instead of <code>ChannelTopicProvider</code>. Since this trait mainly keeps track of mapping incoming to
            outgoing requests it does not have methods that need to be overridden or provided by concrete
            actor classes. Note that incoming to outgoing request relations are 1:N.</p>
        </div>

    </body>
</html>