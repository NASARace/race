<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8"/>
        <title>RACE</title>

        <link href="../race-html.css" rel="stylesheet"/>
    </head>

    <body>
        <div class="navbar">
            <div class=""banner>
                <a href="index.html" ><img class="logo" src="../images/race128.png"></a>
                <p class="doctitle">RACE Manual</p>
            </div>
            <br/>
            <div class="toc">
                <p class="title">Project Links</p>
                <ul>
                    <li><span class="toc level2"><a href="https://github.com/NASARace/race.git">Repository</a></span></li>
                    <li><span class="toc level2"><a href="http://nasarace.github.io/race">Website</a></span></li>
                </ul>
            </div>
            <div class="pagetoc">
                <div class="toc">
                  <p class="title">Page</p>
                  <ul>
                    <li><span class="toc level1"><a href="#local-race-build-properties">local-race-build.properties</a></span></li>
                    <li><span class="toc level1"><a href="#local-build-sbt">local-build.sbt</a></span></li>
                    <li><span class="toc level1"><a href="#caveat">Caveat</a></span></li>
                  </ul>
                </div>
            </div>
            <div class="globaltoc">
                <div class="toc">
                  <p class="title">Contents</p>
                  <ul>
                    <li><span class="toc level1"><a href="../about.html">About RACE</a></span></li>
                    <li>
                      <p class="toc level1">Installing RACE</p>
                      <ul>
                        <li><span class="toc level2"><a href="../installation/prerequisites.html">Prerequisites</a></span></li>
                        <li><span class="toc level2"><a href="../installation/download.html">Downloading RACE</a></span></li>
                        <li><span class="toc level2"><a href="../installation/build.html">Building RACE</a></span></li>
                        <li><span class="toc level2"><a href="../installation/osx.html">OS X Specifics</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1">Using RACE</p>
                      <ul>
                        <li><span class="toc level2"><a href="../usage/running.html">How to Run RACE</a></span></li>
                        <li><span class="toc level2"><a href="../usage/configuration.html">RACE Configuration</a></span></li>
                        <li><span class="toc level2"><a href="../usage/encryption.html">Using Encrypted Configurations</a></span></li>
                        <li><span class="toc level2"><a href="../usage/examples.html">RACE examples</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1"><a href="../actors.html">Actors</a></p>
                      <ul>
                        <li><span class="toc level2"><a href="../actors.html#actor-components-and-properties">Actor Components and Properties</a></span></li>
                        <li><span class="toc level2"><a href="../actors.html#actor-communication">Actor Communication</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1">RACE Design</p>
                      <ul>
                        <li><span class="toc level2"><a href="overview.html">Design Overview</a></span></li>
                        <li><span class="toc level2"><a href="configuration.html">Runtime Configuration</a></span></li>
                        <li><span class="toc level2"><a href="raceactors.html">RaceActors</a></span></li>
                        <li><span class="toc level2"><a href="channeltopics.html">ChannelTopics</a></span></li>
                        <li><span class="toc level2"><a href="worldwind.html">WorldWind Viewer</a></span></li>
                        <li><span class="toc level2"><a href="remotelauncher.html">RemoteLauncher</a></span></li>
                        <li><span class="toc level2"><a href="layers-and-modules.html">Layers and Modules</a></span></li>
                        <li><span class="toc level2"><a href="directory-structure.html">Directory Structure</a></span></li>
                        <li><span class="toc level2 active">Local Build Configuration</span></li>
                        <li><span class="toc level2"><a href="dds.html">RACE and DDS</a></span></li>
                        <li><span class="toc level2"><a href="whyscala.html">Why Scala</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1"><a href="../examples.html">RACE Examples</a></p>
                      <ul>
                        <li><span class="toc level2"><a href="../examples.html#basic-examples">Basic Examples</a></span></li>
                        <li><span class="toc level2"><a href="../examples.html#distributed-operation">Distributed Operation</a></span></li>
                        <li><span class="toc level2"><a href="../examples.html#live-data-import">Live Data Import</a></span></li>
                        <li><span class="toc level2"><a href="../examples.html#data-replay">Data Replay</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1">Documentation</p>
                      <ul>
                        <li><span class="toc level2"><a href="../documentation/overview.html">RACE Documentation Overview</a></span></li>
                        <li><span class="toc level2"><a href="../documentation/presentations.html">Available Slide Presentations</a></span></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1"><a href="../learning.html">Learning Resources</a></p>
                      <ul>
                        <li><span class="toc level2"><a href="../learning.html#scala">Scala</a></span></li>
                        <li><span class="toc level2"><a href="../learning.html#actors-and-akka">Actors and Akka</a></span></li>
                        <li><span class="toc level2"><a href="../learning.html#sbt">SBT</a></span></li>
                        <li><span class="toc level2"><a href="../learning.html#interactive-scala-akka-and-sbt-learning-environment-and-examples">Interactive Scala, Akka and SBT Learning Environment and Examples</a></span></li>
                        <li><span class="toc level2"><a href="../learning.html#git">Git</a></span></li>
                      </ul>
                    </li>
                    <li><span class="toc level1"><a href="../glossary.html">Glossary</a></span></li>
                  </ul>
                </div>
            </div>
        </div>

        <div class="main">
            <h1 id="local-build-configuration" class="title">Local Build Configuration</h1>
            <p>Normally, the purpose of the build system is to automate the build so that it behaves the same on all machines.
            Sometimes you need more control, to override standard build settings according to your environment. The main
            reasons for such a deviation are</p>
            <ul>
              <li>using debug / development versions of 3rd party dependencies (e.g. WorldWind)</li>
              <li>components that separate publicly available interfaces from licensed implementations (e.g. DDS)</li>
            </ul>
            <p>RACE supports this by means of two optional build configuration files in the RACE root directory:</p>
            
            <h2 id="local-race-build-properties" class="section">local-race-build.properties</h2>
            <p>This file contains Java properties to specify settings such as URIs:</p>
            <pre><code>race.wwj_uri=file:///home/me/worldwind</code></pre>
            <p>Those properties can then be referenced in <code>build.sbt</code> or any of the <code>project/*.scala</code> files:</p>
            <pre><code>lazy val wwjProject = RootProject(uri(sys.props.getOrElse(&quot;race.wwj_uri&quot;, &quot;git://github.com/pcmehlitz/WorldWindJava.git#pcm&quot;)))</code></pre>
            
            <h2 id="local-build-sbt" class="section">local-build.sbt</h2>
            <p>This file can override SBT settings, and depends on using <code>project/RaceBuild.scala</code> provided methods to define projects
            in <code>build.sbt</code>, such as:</p>
            <pre><code>lazy val raceCommon = createProject(&quot;race-common&quot;).
  ...
  settings(commonSettings).
  addLibraryDependencies(typesafeConfig,nscalaTime,scalaXml,scalaReflect,jsch,scopt,scalaArm).
  makeExtensible.  // &lt;&lt;&lt; local extension point - settings from here on can be replaced in local-build.sbt
  addLibraryDependencies(omgDDS)</code></pre>
            <p>Note the <code>makeExtensible</code> call, which basically stores the respective SBT Project object for later retrieval and
            modification from a <code>local-build.sbt</code>:</p>
            <pre><code>import RaceBuild._

val raceCommon = extensibleProjects(&quot;race-common&quot;).settings(
  resolvers += &quot;Local Maven Repository&quot; at &quot;file://&quot;+Path.userHome.absolutePath+&quot;/.m2/repository&quot;,
  libraryDependencies += &quot;com.prismtech.cafe&quot; % &quot;cafe&quot; % &quot;2.2.2&quot;
)
...</code></pre>
            <p>Since <code>Project</code> instances are immutable (each of the calls in <code>build.sbt</code> creates a new instance) we can mark
            any stage of the build.sbt project definition as the basis for local extension. This is important so that we can not
            only add new libraries in our <code>local-build.sbt</code> but also replace the ones from <code>build.sbt</code> that follow the <code>makeExtensible</code>
            call.</p>
            <p>Note this mechanism depends on SBT loading <code>*.sbt</code> files in alphabetical order.</p>
            <p>This can basically override all settings of your locally extensible projects, and hence should be used with care. The
            primary justification is to support proprietary 3rd party components that implement publicly available, open sourced
            APIs (such as the OMGs Java 5 PSM for DDS) without the need to keep permanent branches in the repository.</p>
            
            <h2 id="caveat" class="section">Caveat</h2>
            <p>Note that <strong>both files are not stored in the repository</strong> (they are listed in <code>.gitignore</code>). They only reside on the
            local machine.</p>
            <p>Code that is published or stored upstream should <strong>not</strong> depend on such settings. In general, it is better to use
            repository branches for non-permanent specializations.</p>
        </div>

    </body>
</html>