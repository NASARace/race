<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8"/>
        <title>RACE</title>

        <link href="../race-html.css" rel="stylesheet"/>
    </head>

    <body>
        <div class="navbar">
            <div class=""banner>
                <a href="../index.html" ><img class="logo" src="../images/race128.png"></a>
                <p class="doctitle">RACE Manual</p>
            </div>
            <br/>
            <div class="toc">
                <p class="title">Project Links</p>
                <ul>
                    <li><span class="toc level2"><a href="https://github.com/NASARace/race.git">Repository</a></span></li>
                    <li><span class="toc level2"><a href="http://nasarace.github.io/race">Website</a></span></li>
                </ul>
            </div>
            <div class="toc pagetoc">
                <p class="title">Page</p>
                <ul class="nav-list">
                  <li class="level1 active"><a href="#">WorldWind Viewer</a></li>
                  <li class="level2"><a href="#layers-and-panels-races-extension-points">Layers and Panels - RACEs Extension Points</a></li>
                  <li class="level2"><a href="#synchronized-viewers">Synchronized Viewers</a></li>
                </ul>
            </div>
            <div class="toc globaltoc">
                <p class="title">Site</p>
                <ul class="nav-list">
                  <li class="level1 nav-header">RACE Manual</li>
                  <li class="level2"><a href="../index.html">About RACE</a></li>
                  <li class="level2 nav-header">Installing RACE</li>
                  <li class="level3"><a href="../installation/prerequisites.html">Prerequisites</a></li>
                  <li class="level3"><a href="../installation/download.html">Downloading RACE</a></li>
                  <li class="level3"><a href="../installation/build.html">Building RACE</a></li>
                  <li class="level3"><a href="../installation/pitfalls.html">Installation Pitfalls</a></li>
                  <li class="level3"><a href="../installation/osx.html">OS X Specifics</a></li>
                  <li class="level2 nav-header">Using RACE</li>
                  <li class="level3"><a href="../usage/running.html">How to Run RACE</a></li>
                  <li class="level3"><a href="../usage/configuration.html">RACE Configuration</a></li>
                  <li class="level3"><a href="../usage/encryption.html">Using Encrypted Configurations</a></li>
                  <li class="level2 nav-header">RACE Design</li>
                  <li class="level3"><a href="overview.html">Design Overview</a></li>
                  <li class="level3"><a href="actors.html">Actors</a></li>
                  <li class="level3"><a href="configuration.html">Runtime Configuration</a></li>
                  <li class="level3"><a href="raceactors.html">RaceActors</a></li>
                  <li class="level3"><a href="channeltopics.html">ChannelTopics</a></li>
                  <li class="level3"><a href="embedded-objects.html">Embedded Objects</a></li>
                  <li class="level3"><a href="connectivity.html">Connecting External Systems</a></li>
                  <li class="level3"><a href="remoting.html">Remote RaceActors and Distributed RACE Applications</a></li>
                  <li class="level3"><a href="remotelauncher.html">RemoteLauncher</a></li>
                  <li class="level3"><a href="hc.html">Heterogeneous Computing in RACE</a></li>
                  <li class="level3"><a href="parsing.html">RACE Parsers</a></li>
                  <li class="level3"><a href="archive-replay.html">Archive and Replay</a></li>
                  <li class="level3"><a href="timeseries.html">Time Series Analysis</a></li>
                  <li class="level3"><a href="trajectory.html">Trajectory Infrastructure</a></li>
                  <li class="level3"><a href="rgis.html">RACE GIS Support</a></li>
                  <li class="level3 active"><a href="#">WorldWind Viewer</a></li>
                  <li class="level3"><a href="http-server.html">HttpServer</a></li>
                  <li class="level3"><a href="http-client.html">HttpImportActor</a></li>
                  <li class="level3"><a href="share.html">SHARE - System for Hierarchical Ad hoc Reporting</a></li>
                  <li class="level3"><a href="layers-and-modules.html">Layers and Modules</a></li>
                  <li class="level3"><a href="directory-structure.html">Directory Structure</a></li>
                  <li class="level3"><a href="repository.html">Repository Structure</a></li>
                  <li class="level3"><a href="local-build.html">Local Build Configuration</a></li>
                  <li class="level3"><a href="dds.html">RACE and DDS</a></li>
                  <li class="level3"><a href="extproject.html">Using RACE from External Projects</a></li>
                  <li class="level3"><a href="whyscala.html">Why Scala</a></li>
                  <li class="level2 nav-header">Documentation</li>
                  <li class="level3"><a href="../documentation/overview.html">RACE Documentation Overview</a></li>
                  <li class="level3"><a href="../documentation/presentations.html">Available Slide Presentations</a></li>
                  <li class="level2 nav-header">Annex</li>
                  <li class="level3"><a href="../annex/project-log.html">Project Log</a></li>
                  <li class="level3"><a href="../annex/examples.html">RACE Examples</a></li>
                  <li class="level3"><a href="../annex/known-problems.html">Known Problems</a></li>
                  <li class="level3"><a href="../annex/changes.html">Changes</a></li>
                  <li class="level3"><a href="../annex/todo.html">TODO List</a></li>
                  <li class="level3"><a href="../annex/learning.html">Learning Resources</a></li>
                  <li class="level3"><a href="../annex/glossary.html">Glossary</a></li>
                </ul>
            </div>
        </div>

        <div class="main">
            <h1 id="worldwind-viewer" class="title">WorldWind Viewer</h1>
            <p>One of the primary use cases of RACE is to visualize large geospatial, dynamic data sets, such as
            live flight positions within the whole NAS. Respective applications vary widely in terms of:</p>
            <ul>
              <li>input sources</li>
              <li>context aware rendering of display relevant data</li>
              <li>interactions</li>
            </ul>
            <p>Rendering intensive graphical user interfaces tend to require a large amount of code that is often
            platform specific. In addition, related code is difficult to develop because user interface
            frameworks are often not thread safe, and thus need explicit, error prone and hard to test
            synchronization between asynchronous data acquisition- and user interface (event dispatcher) threads.</p>
            <p>RACE includes substantial infrastructure to mitigate these challenges. Centerpiece of this
            infrastructure is <a href="https://worldwind.arc.nasa.gov/">NASA WorldWind</a> - an open sourced Java- and <a href="https://www.opengl.org/">OpenGL</a>-based geo viewer
            that runs on all major platforms and can be embedded into various applications.</p>
            
            <h2 id="layers-and-panels-races-extension-points" class="section"><a class="anchor-link left" href="#layers-and-panels-races-extension-points"><i class="icofont-laika">&#xef71;</i></a>Layers and Panels - RACEs Extension Points</h2>
            <p>The primary <a href="https://worldwind.arc.nasa.gov/index.html?root=java">WorldWind concept</a> in the context of RACE is the <a href="http://builds.worldwind.arc.nasa.gov/worldwind-releases/daily/docs/api/gov/nasa/worldwind/layers/RenderableLayer.html">RenderableLayer</a>, which represents
            a display relevant data set that can be separately controlled in terms of visibility, rendering details and
            updates. RACE uses <code>RaceLayers</code> to map its bus channels to WorldWind layers. While a <code>RaceLayer</code>
            is a GUI object that executes within the user interface thread, it has an associated
            <code>RaceLayerActor</code> which is responsible for data acquisition by means of channel subscription.
            Since <code>RaceLayerActors</code> execute within Akka threads, they use a dedicated queue within the
            associated <code>RaceLayer</code> to perform the thread-safe handover of display data.</p>
            <p>The second general concept is the <em>UI panel</em>, which represents a part of the user interface outside
            of, but potentially interacting with, WorldWind. RACE comes with panels for various tasks such as
            controlling view positions, selecting layers and displaying information about selected objects.</p>
            <p>UI panels are collapsible and stacked in a column to the left of the toplevel window, whereas
            WorldWind occupies the large canvas to the right of the panel column.</p>
            <p><img class="center scale80" src="../images/race-viewer.svg" alt="WorldWind Viewer"></p>
            <p>WorldWind is incorporated into RACE applications by means of a <code>RaceViewerActor</code>, which is just
            a normal <code>RaceActor</code> within RACE configurations. However, <code>RaceViewerActors</code> themselves can
            be extensively configured with both <code>RaceLayers</code> and (less often) UI panels:</p>
            <pre><code>universe {
    ...
    actors = [
        ...
        { name = &quot;geoViewer&quot;
          class = &quot;gov.nasa.race.ww.RaceViewerActor&quot;
          ...
          layers = [
              { name = &quot;livePos&quot;
                class = &quot;gov.nasa.race.ww.air.FlightPosLayer&quot;
                read-from = &quot;/live/fpos&quot;
                description = &quot;SWIM sfdps flight positions&quot; ...
              },
           ...</code></pre>
            <p>Just as <code>RaceLayerActors</code>, the <code>RaceViewerActor</code> has a UI dual in form of the <code>RaceView</code>, which
            is both the aggregation and the <a href="https://en.wikipedia.org/wiki/Mediator_pattern">mediator</a> between the configured panels and the WorldWind window.</p>
            
            <h2 id="synchronized-viewers" class="section"><a class="anchor-link left" href="#synchronized-viewers"><i class="icofont-laika">&#xef71;</i></a>Synchronized Viewers</h2>
            <p>The data that is acquired through RACE channels does not have to represent external entities such
            as aircraft, and does not need to be displayed in <code>RaceLayers</code>. The whole RACE viewer
            infrastructure lends itself naturally to use RACE channels on the global bus for the purpose of
            synchronizing RaceViewers across the network.</p>
            <p>To that end, the viewer infrastructure includes a <code>SyncPanel</code>/<code>SyncActor</code> pair, which can publish
            viewer changes such as eye position and layer selection to a global channel, and conversely subscribe
            to this channel to update the local display with remote viewer changes. This is a powerful basis
            to implement applications such as situation rooms because it</p>
            <ul>
              <li>supports control of synchronization aspects at the local node</li>
              <li>requires minimal data transfer for updates</li>
              <li>is robust in terms of re-synchronization</li>
            </ul>
            <p>Moreover, by using different synchronization channels it is easy to create and switch between different display groups.</p>
            <p>Viewer synchronization is <em>not</em> hardwired or restricted to a fixed set of viewer parameters such as eye position.</p>
            <p>Since application specific data and rendering is provided through new <code>RaceLayers</code>, those layers are also responsible
            for adding related synchronization commands. For instance, the generic <code>FlightLayer</code> implementation includes a number
            of commands for selected flight objects, such as hiding/showing flight paths. This is achieved by overriding the
            <code>changeObject(objectId: String, action: String)</code> method of the <code>RaceLayer</code> class - layers are free to add their own
            object ids and action keys.</p>
            <p>The <code>SyncPanel</code> implementation that is distributed with RACE supports synchronization control for</p>
            <ul>
              <li>eye positions</li>
              <li>operation on the selected layer</li>
              <li>operations on the selected layer object</li>
            </ul>
            <p>Synchronization resonance (bouncing back external synchronization commands) is prevented by means of blackout periods.
            Synchronization events are only sent out if they don&#39;t exceed a configurable threshold duration since the last local
            user input.</p>
            <p>If applications need more control they can provide their own panel and configure it instead of the standard sync panel.</p>
        </div>

    </body>
</html>